// Traducciones para los idiomas
const translations = {
    es: {
        // Títulos y textos principales
        "app-title": "Aprende En Tu Hogar",
        "app-tagline": "Tu futuro, Tú lo elijes",
        "offline-text": "Offline",
        "courses-title": "Cursos Disponibles",
        
        // Nombres de cursos
        "math-title": "Matemática",
        "math-desc": "Suma, resta, multiplicación, división, potencias y raíces cuadradas",
        "com-title": "Comunicación",
        "com-desc": "Gramática, comprensión lectora y expresión escrita",
        "sci-title": "Ciencias",
        "sci-desc": "Biología, física y química",
        "hist-title": "Historia del Perú",
        "hist-desc": "Desde las culturas preincaicas hasta la época republicana",
        
        // Botones y textos comunes
        "start-course": "Comenzar Curso",
        "question": "Pregunta",
        "of": "de",
        "prev": "Anterior",
        "next": "Siguiente",
        "finish": "Finalizar",
        
        // Resultados
        "completed": "¡Curso Completado!",
        "back-courses": "Volver a Cursos",
        "repeat-course": "Repetir Curso",
        
        // Instalación
        "install-here": "INSTALACIÓN AQUI",
        "install-app": "Instalar App",
        "footer-desc": "Aprende En Tu Hogar diseñada para zonas rurales sin conexión a internet",
        
        // Alertas y mensajes
        "select-answer": "Por favor, selecciona una respuesta antes de continuar.",
        "excellent-score": "¡Excelente! Has respondido todas las preguntas correctamente.",
        "good-score": "¡Muy bien! Has demostrado un buen conocimiento del tema.",
        "medium-score": "Buen trabajo, pero puedes mejorar. Revisa los temas y vuelve a intentarlo.",
        "low-score": "Sigue practicando. Revisa los conceptos y vuelve a intentarlo."
    },
    
    qu: {
        // Títulos y textos principales
        "app-title": "Yachay Wasipi",
        "app-tagline": "Qhepaman, Qanqa akllanki",
        "offline-text": "Mana Internetpi",
        "courses-title": "Kawsay Yachaykunas",
        
        // Nombres de cursos
        "math-title": "Yupana Yachay",
        "math-desc": "Yapay, qichuy, miray, rakisqa, hatunyachiy, sikwiracha",
        "com-title": "Rimay Yachay",
        "com-desc": "Simi kamachiy, qillqasqa hamut'ay, qillqay",
        "sci-title": "Kamay Yachay",
        "sci-desc": "Kawsay yachay, llamk'ay yachay, ch'ilan yachay",
        "hist-title": "Piruwpa ñawpaq kawsaynin",
        "hist-desc": "Ñawpaq Inka pachamanta kamakuna Republican pachakama",
        
        // Botones y textos comunes
        "start-course": "Yachayta Qallariy",
        "question": "Tapuy",
        "of": "manta",
        "prev": "Ñawpaqman",
        "next": "Qhipaman",
        "finish": "Tukuchiy",
        
        // Resultados
        "completed": "¡Yachay Tukusqa!",
        "back-courses": "Yachaykunaman Kutiy",
        "repeat-course": "Yachayta Kutichiymanta",
        
        // Instalación
        "install-here": "WILLAY CHURANA KAYPI",
        "install-app": "Appta Churanay",
        "footer-desc": "Yachay Wasipi internetniyuq mana llaqtakunapaq kamachisqa",
        
        // Alertas y mensajes
        "select-answer": "Ama hina kaspa, kutichiyta akllay qhipaman riyta munaspa.",
        "excellent-score": "¡Ancha allin! Llapanta allinta kutichirqanki.",
        "good-score": "¡Allinmi! Yachaykimantam rikuchirqanki.",
        "medium-score": "Allin llamk'ay, ichaqa aswan allin kanman. T'eqsimanta qhawaspam, kutichiy.",
        "low-score": "Yachayta llamk'achkaspalla. T'eqsimanta qhawaspam, kutichiy."
    },
    
    ay: {
        // Títulos y textos principales
        "app-title": "Yatiqaña Utampi",
        "app-tagline": "Qhipa uru, jumataki akhamawa",
        "offline-text": "Jan Internetpi",
        "courses-title": "Yatiqañataki yatiyañanaka",
        
        // Nombres de cursos
        "math-title": "Yupay Yatiqaña",
        "math-desc": "Yapayaña, juch'ayaña, jisk'a mayjt'ayaña, jaljayaña, jach'a yatiyaña, k'uchu tupu",
        "com-title": "Aru Yatiqaña",
        "com-desc": "Aru kamachi, qillqa amuyaña, qillqayaña",
        "sci-title": "Yatichaña",
        "sci-desc": "Kawsay yatiyaña, ch'ama yatiyaña, qullqi yatiyaña",
        "hist-title": "Piruwpa nayra pacha",
        "hist-desc": "Nayra Inka pachamanta kamakuna República pachakama",
        
        // Botones y textos comunes
        "start-course": "Yatiqañata Qalltaña",
        "question": "Jiskt'a",
        "of": "manta",
        "prev": "Nayraman",
        "next": "Qhipaman",
        "finish": "Tukuyaña",
        
        // Resultados
        "completed": "¡Yatiqaña Tuku!",
        "back-courses": "Yatiqañanakarux Kutixaña",
        "repeat-course": "Yatiqañata Kutixaña",
        
        // Instalación
        "install-here": "UÑJAWI CHURANA AKANXA",
        "install-app": "Appta Churaña",
        "footer-desc": "Yatiqaña Utampi internetni jan markanakataki kamachi",
        
        // Alertas y mensajes
        "select-answer": "Ukat janiw, jiskt'äwi ajlliñ munañ qhiparu sarxañ muni.",
        "excellent-score": "¡Wali sumawa! Tukuyax wali sum jiskt'äw uñtawaytawa.",
        "good-score": "¡Sumawa! Yatixatäw uñjachawaytawa.",
        "medium-score": "Suma llamk'äwi, ukax wakiskiriw suma katuqäkiti. Yatiqäwinak uñt'asisxaniwa, kutiyaña.",
        "low-score": "Yatiqañatakiw llamk'chañawa. Yatiqäwinak uñt'asisxaniwa, kutiyaña."
    }
};

// Idioma actual (por defecto español)
let currentLanguage = 'es';

// Cambiar idioma
function changeLanguage(lang) {
    currentLanguage = lang;
    
    // Actualizar botones de idioma
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.lang === lang) {
            btn.classList.add('active');
        }
    });
    
    // Actualizar todos los textos traducibles
    updateTexts();
    
    // Actualizar preguntas si estamos en un quiz
    if (window.currentCourse && window.currentQuestionIndex !== undefined) {
        updateQuizLanguage();
    }
}

// Actualizar todos los textos
function updateTexts() {
    // Elementos con data-key
    document.querySelectorAll('[data-key]').forEach(element => {
        const key = element.getAttribute('data-key');
        if (translations[currentLanguage][key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translations[currentLanguage][key];
            } else if (element.tagName === 'BUTTON' && element.id === 'nextBtn') {
                // Caso especial para el botón "Siguiente/Finalizar"
                const isLastQuestion = window.currentQuestionIndex === 
                    (window.questionsData?.[window.currentCourse]?.length - 1);
                element.textContent = isLastQuestion ? 
                    translations[currentLanguage]['finish'] : 
                    translations[currentLanguage][key];
            } else {
                element.textContent = translations[currentLanguage][key];
            }
        }
    });
    
    // Elementos especiales por ID
    const specialElements = {
        'app-title': document.getElementById('app-title'),
        'app-tagline': document.getElementById('app-tagline'),
        'offline-text': document.getElementById('offline-text'),
        'courses-title': document.getElementById('courses-title'),
        'footer-desc': document.getElementById('footer-desc')
    };
    
    for (const [key, element] of Object.entries(specialElements)) {
        if (element && translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    }
    
    // Guardar preferencia de idioma
    localStorage.setItem('app-language', currentLanguage);
}

// Actualizar preguntas del quiz
function updateQuizLanguage() {
    if (window.currentCourse && window.showQuestion) {
        window.showQuestion();
    }
}

// Inicializar selector de idioma
function initLanguageSelector() {
    // Botones de cambio de idioma
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            changeLanguage(this.dataset.lang);
        });
    });
    
    // Cargar idioma guardado
    const savedLang = localStorage.getItem('app-language');
    if (savedLang && translations[savedLang]) {
        changeLanguage(savedLang);
    }
}

// Inicializar cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', function() {
    initLanguageSelector();
    
    // Sobrescribir función showQuestion para incluir traducción
    const originalShowQuestion = window.showQuestion;
    if (originalShowQuestion) {
        window.showQuestion = function() {
            originalShowQuestion.apply(this, arguments);
            
            // Actualizar textos del quiz
            updateTexts();
        };
    }
});